(()=>{var e={};e.id=1018,e.ids=[1018],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},11532:(e,a,s)=>{"use strict";s.r(a),s.d(a,{default:()=>M});var r=s(60687),t=s(43210),n=s(44493),i=s(29523),l=s(63503),d=s(89667),o=s(34729),c=s(71669),m=s(15079),h=s(27605),u=s(63442),p=s(45880),x=s(31568),j=s(11516),f=s(35265),g=s(80489),v=s(41936),k=s(35137),b=s(57207),w=s(29867),y=s(93500),N=s(6211),P=s(42692),C=s(66420);let A=p.Ik({kode:p.Yj().min(3,{message:"Kode minimal 3 karakter."}).max(50),nama:p.Yj().min(5,{message:"Nama minimal 5 karakter."}).max(255),deskripsi:p.Yj().optional().or(p.eu("")),kategori:p.k5(C.Xn,{required_error:"Kategori wajib diisi."})});function M(){let{user:e,isLoading:a}=(0,x.A)(),{toast:s}=(0,w.dj)(),[p,M]=(0,t.useState)([]),[S,T]=(0,t.useState)(!1),[E,_]=(0,t.useState)(null),[K,q]=(0,t.useState)(null),[z,R]=(0,t.useState)(!0),[$,B]=(0,t.useState)(!1),[I,L]=(0,t.useState)(""),[G,O]=(0,t.useState)("semua"),X=(0,h.mN)({resolver:(0,u.u)(A),defaultValues:{kode:"",nama:"",deskripsi:"",kategori:void 0}}),D=async()=>{R(!0);try{let e=await fetch("/api/mapel");if(!e.ok){let a=await e.json();throw Error(a.message||"Gagal mengambil data mata pelajaran")}let a=await e.json();M(a)}catch(e){s({title:"Error",description:e.message||"Tidak dapat memuat data.",variant:"destructive"})}finally{R(!1)}};if(a)return(0,r.jsx)("div",{className:"flex h-full items-center justify-center",children:(0,r.jsx)(j.A,{className:"h-12 w-12 animate-spin text-primary"})});if(!e||"admin"!==e.role&&"superadmin"!==e.role)return(0,r.jsx)("p",{children:"Akses Ditolak. Anda harus menjadi admin untuk melihat halaman ini."});let V=async e=>{B(!0);let a=E?`/api/mapel/${E.id}`:"/api/mapel",r=E?"PUT":"POST",t=E?{nama:e.nama,deskripsi:e.deskripsi,kategori:e.kategori}:e;try{let n=await fetch(a,{method:r,headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!n.ok){let e=await n.json();throw Error(e.message||"Gagal menyimpan mata pelajaran")}s({title:"Berhasil!",description:`Mata pelajaran ${e.nama} telah ${E?"diperbarui":"ditambahkan"}.`}),T(!1),_(null),X.reset(),D()}catch(e){s({title:"Error",description:e.message||"Terjadi kesalahan.",variant:"destructive"})}finally{B(!1)}},F=e=>{_(e),T(!0)},J=e=>{q(e)},H=async()=>{if(K){B(!0);try{let e=await fetch(`/api/mapel/${K.id}`,{method:"DELETE"});if(!e.ok){let a=await e.json();throw Error(a.message||"Gagal menghapus mata pelajaran")}s({title:"Dihapus!",description:`Mata pelajaran ${K.nama} telah dihapus.`}),D()}catch(e){s({title:"Error",description:e.message||"Terjadi kesalahan.",variant:"destructive"})}finally{B(!1),q(null)}}},Y=(0,t.useMemo)(()=>p.filter(e=>{let a=""===I||e.nama.toLowerCase().includes(I.toLowerCase())||e.kode.toLowerCase().includes(I.toLowerCase()),s="semua"===G||e.kategori===G;return a&&s}),[p,I,G]);return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex flex-col md:flex-row items-start md:items-center justify-between gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-3xl font-headline font-semibold",children:"Manajemen Mata Pelajaran"}),(0,r.jsx)("p",{className:"text-muted-foreground mt-1",children:"Kelola semua mata pelajaran yang ditawarkan oleh sekolah."})]}),(0,r.jsxs)(i.$,{onClick:()=>{_(null),X.reset(),T(!0)},disabled:z,children:[(0,r.jsx)(f.A,{className:"mr-2 h-4 w-4"})," Tambah Mata Pelajaran"]})]}),(0,r.jsxs)(n.Zp,{className:"shadow-lg",children:[(0,r.jsx)(n.aR,{children:(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)(n.ZB,{className:"flex items-center",children:[(0,r.jsx)(g.A,{className:"mr-2 h-6 w-6 text-primary"}),"Daftar Mata Pelajaran Sekolah"]}),(0,r.jsxs)(n.BT,{children:["Total: ",Y.length," mata pelajaran."]})]}),(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row gap-2 w-full sm:w-auto",children:[(0,r.jsxs)("div",{className:"relative flex-grow sm:flex-grow-0",children:[(0,r.jsx)(v.A,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),(0,r.jsx)(d.p,{placeholder:"Cari kode atau nama...",value:I,onChange:e=>L(e.target.value),className:"pl-8 w-full sm:w-[200px] lg:w-[250px]"})]}),(0,r.jsxs)(m.l6,{value:G,onValueChange:O,children:[(0,r.jsx)(m.bq,{className:"w-full sm:w-[200px]",children:(0,r.jsx)(m.yv,{placeholder:"Filter Kategori"})}),(0,r.jsxs)(m.gC,{children:[(0,r.jsx)(m.eb,{value:"semua",children:"Semua Kategori"}),C.Xn.map(e=>(0,r.jsx)(m.eb,{value:e,children:e},e))]})]})]})]})}),(0,r.jsx)(n.Wu,{children:z?(0,r.jsxs)("div",{className:"flex justify-center items-center h-40",children:[(0,r.jsx)(j.A,{className:"h-8 w-8 animate-spin text-primary"}),(0,r.jsx)("p",{className:"ml-2",children:"Memuat data..."})]}):Y.length>0?(0,r.jsx)(P.F,{className:"h-[60vh]",children:(0,r.jsxs)(N.XI,{children:[(0,r.jsx)(N.A0,{className:"sticky top-0 bg-card z-10",children:(0,r.jsxs)(N.Hj,{children:[(0,r.jsx)(N.nd,{children:"Kode"}),(0,r.jsx)(N.nd,{children:"Nama Mata Pelajaran"}),(0,r.jsx)(N.nd,{children:"Kategori"}),(0,r.jsx)(N.nd,{children:"Deskripsi"}),(0,r.jsx)(N.nd,{className:"text-right",children:"Tindakan"})]})}),(0,r.jsx)(N.BF,{children:Y.map(e=>(0,r.jsxs)(N.Hj,{children:[(0,r.jsx)(N.nA,{className:"font-medium",children:e.kode}),(0,r.jsx)(N.nA,{children:e.nama}),(0,r.jsx)(N.nA,{children:e.kategori}),(0,r.jsx)(N.nA,{className:"max-w-xs truncate",title:e.deskripsi||"",children:e.deskripsi||"-"}),(0,r.jsxs)(N.nA,{className:"text-right",children:[(0,r.jsx)(i.$,{variant:"ghost",size:"sm",onClick:()=>F(e),className:"mr-2 text-primary hover:text-primary/80",children:(0,r.jsx)(k.A,{className:"h-4 w-4"})}),(0,r.jsx)(i.$,{variant:"ghost",size:"sm",onClick:()=>J(e),className:"text-destructive hover:text-destructive/80",children:(0,r.jsx)(b.A,{className:"h-4 w-4"})})]})]},e.id))})]})}):(0,r.jsxs)("div",{className:"p-6 text-center text-muted-foreground bg-muted/30 rounded-md",children:[(0,r.jsx)("p",{className:"mb-2",children:"Tidak ada mata pelajaran yang cocok dengan filter saat ini."}),""===I&&"semua"===G&&(0,r.jsxs)(i.$,{onClick:()=>{_(null),X.reset(),T(!0)},children:[(0,r.jsx)(f.A,{className:"mr-2 h-4 w-4"})," Tambah Mata Pelajaran Pertama"]})]})})]}),(0,r.jsx)(l.lG,{open:S,onOpenChange:e=>{T(e),e||_(null)},children:(0,r.jsxs)(l.Cf,{className:"sm:max-w-lg",children:[(0,r.jsxs)(l.c7,{children:[(0,r.jsx)(l.L3,{children:E?"Edit Mata Pelajaran":"Tambah Mata Pelajaran Baru"}),(0,r.jsx)(l.rr,{children:E?`Perbarui detail untuk ${E.nama}.`:"Isi detail mata pelajaran baru di bawah ini."})]}),(0,r.jsx)(c.lV,{...X,children:(0,r.jsxs)("form",{onSubmit:X.handleSubmit(V),className:"space-y-4 py-4",children:[(0,r.jsx)(c.zB,{control:X.control,name:"kode",render:({field:e})=>(0,r.jsxs)(c.eI,{children:[(0,r.jsx)(c.lR,{children:"Kode Mata Pelajaran"}),(0,r.jsx)(c.MJ,{children:(0,r.jsx)(d.p,{placeholder:"Contoh: MTK-X, FIS-XI-IPA",...e,disabled:!!E})}),E&&(0,r.jsx)(c.Rr,{children:"Kode tidak dapat diubah."}),(0,r.jsx)(c.C5,{})]})}),(0,r.jsx)(c.zB,{control:X.control,name:"nama",render:({field:e})=>(0,r.jsxs)(c.eI,{children:[(0,r.jsx)(c.lR,{children:"Nama Mata Pelajaran"}),(0,r.jsx)(c.MJ,{children:(0,r.jsx)(d.p,{placeholder:"Contoh: Matematika Kelas X",...e})}),(0,r.jsx)(c.C5,{})]})}),(0,r.jsx)(c.zB,{control:X.control,name:"kategori",render:({field:e})=>(0,r.jsxs)(c.eI,{children:[(0,r.jsx)(c.lR,{children:"Kategori"}),(0,r.jsxs)(m.l6,{onValueChange:e.onChange,value:e.value,children:[(0,r.jsx)(c.MJ,{children:(0,r.jsx)(m.bq,{children:(0,r.jsx)(m.yv,{placeholder:"Pilih kategori mata pelajaran"})})}),(0,r.jsx)(m.gC,{children:C.Xn.map(e=>(0,r.jsx)(m.eb,{value:e,children:e},e))})]}),(0,r.jsx)(c.C5,{})]})}),(0,r.jsx)(c.zB,{control:X.control,name:"deskripsi",render:({field:e})=>(0,r.jsxs)(c.eI,{children:[(0,r.jsx)(c.lR,{children:"Deskripsi (Opsional)"}),(0,r.jsx)(c.MJ,{children:(0,r.jsx)(o.T,{placeholder:"Deskripsi singkat mata pelajaran...",...e,value:e.value??""})}),(0,r.jsx)(c.C5,{})]})}),(0,r.jsxs)(l.Es,{children:[(0,r.jsx)(i.$,{type:"button",variant:"outline",onClick:()=>{T(!1),_(null)},disabled:$,children:"Batal"}),(0,r.jsxs)(i.$,{type:"submit",disabled:$||z,children:[$&&(0,r.jsx)(j.A,{className:"mr-2 h-4 w-4 animate-spin"}),E?"Simpan Perubahan":"Simpan Mata Pelajaran"]})]})]})})]})}),(0,r.jsx)(y.Lt,{open:!!K,onOpenChange:e=>{e||q(null)},children:(0,r.jsxs)(y.EO,{children:[(0,r.jsxs)(y.wd,{children:[(0,r.jsx)(y.r7,{children:"Konfirmasi Penghapusan"}),(0,r.jsxs)(y.$v,{children:['Apakah Anda yakin ingin menghapus mata pelajaran "',K?.nama,'"? Tindakan ini akan menghapus semua data terkait (struktur kurikulum, silabus, RPP) yang menggunakan mata pelajaran ini.']})]}),(0,r.jsxs)(y.ck,{children:[(0,r.jsx)(y.Zr,{onClick:()=>q(null),disabled:$,children:"Batal"}),(0,r.jsxs)(y.Rx,{onClick:H,className:"bg-destructive hover:bg-destructive/90",disabled:$,children:[$&&(0,r.jsx)(j.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Ya, Hapus"]})]})]})})]})}},17357:(e,a,s)=>{Promise.resolve().then(s.bind(s,35162))},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},35137:(e,a,s)=>{"use strict";s.d(a,{A:()=>r});let r=(0,s(82614).A)("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]])},35162:(e,a,s)=>{"use strict";s.r(a),s.d(a,{default:()=>r});let r=(0,s(12907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/home/user/studio/src/app/(authenticated)/admin/mata-pelajaran/page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/home/user/studio/src/app/(authenticated)/admin/mata-pelajaran/page.tsx","default")},35265:(e,a,s)=>{"use strict";s.d(a,{A:()=>r});let r=(0,s(82614).A)("CirclePlus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]])},42692:(e,a,s)=>{"use strict";s.d(a,{F:()=>l});var r=s(60687),t=s(43210),n=s(68123),i=s(4780);let l=t.forwardRef(({className:e,children:a,...s},t)=>(0,r.jsxs)(n.bL,{ref:t,className:(0,i.cn)("relative overflow-hidden",e),...s,children:[(0,r.jsx)(n.LM,{className:"h-full w-full rounded-[inherit]",children:a}),(0,r.jsx)(d,{}),(0,r.jsx)(n.OK,{})]}));l.displayName=n.bL.displayName;let d=t.forwardRef(({className:e,orientation:a="vertical",...s},t)=>(0,r.jsx)(n.VM,{ref:t,orientation:a,className:(0,i.cn)("flex touch-none select-none transition-colors","vertical"===a&&"h-full w-2.5 border-l border-l-transparent p-[1px]","horizontal"===a&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",e),...s,children:(0,r.jsx)(n.lr,{className:"relative flex-1 rounded-full bg-border"})}));d.displayName=n.VM.displayName},57677:(e,a,s)=>{Promise.resolve().then(s.bind(s,11532))},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},66964:(e,a,s)=>{"use strict";s.r(a),s.d(a,{GlobalError:()=>i.a,__next_app__:()=>m,pages:()=>c,routeModule:()=>h,tree:()=>o});var r=s(65239),t=s(48088),n=s(88170),i=s.n(n),l=s(30893),d={};for(let e in l)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>l[e]);s.d(a,d);let o={children:["",{children:["(authenticated)",{children:["admin",{children:["mata-pelajaran",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,35162)),"/home/user/studio/src/app/(authenticated)/admin/mata-pelajaran/page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,38734)),"/home/user/studio/src/app/(authenticated)/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,57398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(s.t.bind(s,89999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(s.t.bind(s,65284,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(s.bind(s,94431)),"/home/user/studio/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,57398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(s.t.bind(s,89999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(s.t.bind(s,65284,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]}.children,c=["/home/user/studio/src/app/(authenticated)/admin/mata-pelajaran/page.tsx"],m={require:s,loadChunk:()=>Promise.resolve()},h=new r.AppPageRouteModule({definition:{kind:t.RouteKind.APP_PAGE,page:"/(authenticated)/admin/mata-pelajaran/page",pathname:"/admin/mata-pelajaran",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},79551:e=>{"use strict";e.exports=require("url")}};var a=require("../../../../webpack-runtime.js");a.C(e);var s=e=>a(a.s=e),r=a.X(0,[4447,7689,2123,5814,2327,1758,2065,8123,7895,6861,3949,6498],()=>s(66964));module.exports=r})();